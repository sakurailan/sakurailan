<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="zh-tw">
<head>
<meta name="Generator" content="EditPlus">
<meta name="Author" content="男丁格爾's 脫殼玩">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="Content-Script-Type" content="text/javascript">
<meta http-equiv="Content-Style-Type" content="text/css">
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>
<title>輪播效果</title>
<style type="text/css">
	#abgne-block-20120804 {
		width: 552px;	/* 圖片寬度 + 縮圖寬度 + 間隔 8px */
		height: 300px;	/* 圖片高度 */
		padding: 6px 10px;
		position: relative;
		border: 1px solid #ccc;
	}
	#abgne-block-20120804 ul, #abgne-block-20120804 li {
		margin: 0;
		padding: 0;
		list-style: none;
	}
	#abgne-block-20120804 img {
		border: none;
	}
	#abgne-block-20120804 .photo {
		width: 450px;	/* 圖片寬度 */
		height: 300px;	/* 圖片高度 */
		position: absolute;
	}
	#abgne-block-20120804 .desc-block {
		position: absolute;
		bottom: 0;
		left: 0;
		width: 450px;	/* 圖片寬度 */
		height: 32px;
	}
	#abgne-block-20120804 .desc-bg, #abgne-block-20120804 .desc-title {
		position: absolute;
		width: 430px;	/* 圖片寬度 - padding * 2 */
		background: #000;
		top: 0;
		height: 24px;
		padding: 4px 10px;
	}
	#abgne-block-20120804 .desc-title {
		color: #fff;
		background: none;
		line-height: 24px;
	}
	#abgne-block-20120804 #playPause-btn {	/* 播放/暫停鈕 */
		position: absolute;
		display: block;
		right: 5px;
		bottom: 5px;
		width: 21px;
		height: 21px;
		width: 21px;
		height: 21px;
		text-indent: -999px;
	}
	#abgne-block-20120804 .playPause-btn-play {
		background: url(images/sprite.png) no-repeat -21px 0px;
	}
	#abgne-block-20120804 .playPause-btn-pause {
		background: url(images/sprite.png) no-repeat 0px 0px;
	}
	#abgne-block-20120804 .thumbs {
		width: 94px;
		height: 288px;	/* 圖片高度 - padding-top */
		padding-top: 12px;
		right: 10px;
		position: absolute;
	}
	#abgne-block-20120804 .carousel {
		height: 280px;
		position: relative;
		overflow: hidden;
	}
	#abgne-block-20120804 .carousel .nav-bar {
		float: left;
		width: 2px;
		height: 63px;
		margin-right: 2px;
	}
	#abgne-block-20120804 .carousel img {
		float: left;
		width: 90px;
		height: 63px;
	}
	#abgne-block-20120804 .carousel ul {
		position: absolute;
	}
	#abgne-block-20120804 .carousel li {
		width: 94px;
		height: 72px;
	}
	#abgne-block-20120804 .carousel .current .nav-bar {	/* 當被點選時，縮圖左邊的顏色 */
		background: #007acc;
	}
	#abgne-block-20120804 .thumbs .prev, #abgne-block-20120804 .thumbs .next {	/* 縮圖上下的控制鈕 */
		position: absolute;
		left: 43px;
		width: 12px;
		height: 0px;
		padding-top: 6px;
		overflow: hidden;
		display: block;
		cursor: pointer;
		background: url(images/sprite.png) no-repeat 0 0;
	}
	#abgne-block-20120804 .thumbs .prev {
		top: 0px;
		background-position: 0 -21px;
	}
	#abgne-block-20120804 .thumbs .next {
		bottom: -2px;
		background-position: 0 -27px;
	}
</style>
<script type="text/javascript">
	$(function(){
		// 先一一取得相關的元素及高度
		var $block = $('#abgne-block-20120804'), 
			$photo = $block.find('.photo'), 
			$photoA = $photo.find('a'), 
			$photoImg = $photoA.find('img'), 
			$photoDesc = $photoA.find('.desc-title'), 
			$thumbs = $block.find('.thumbs'), 
			$carousel = $block.find('.carousel'), 
			_carouselHeight = $carousel.height(), 
			$playPauseBtn = $photo.append('<a href="#playPause" class="playPause-btn-pause" id="playPause-btn" title="暫停">暫停</a>').find('#playPause-btn'), 
			$ul = $thumbs.find('ul'), 
			$li = $ul.find('li'), 
			_liHeight = $li.height(), 
			_set = Math.ceil(_carouselHeight / _liHeight), 
			_count = Math.ceil($li.length / _set), 
			_height = _set * _liHeight * -1, 
			timer, speed = 3000, _animateSpeed = 400, // 分別設定輪播速度及動畫速度
			_index = 0, _countIndex = 0;
		
		// 先在縮圖前面都插入一個 .nav-bar, 主要是當點選到該縮圖時的效果
		$('<span class="nav-bar"></span>').insertBefore($li.find('img'));
		// 先讓描述區塊的背景有透明度
		$block.find('.desc-bg').css('opacity', 0.7);
		
		// 如果圖片組數超出一次能顯示的數量時, 產生可以切換的上下鈕
		var $controls = null;
		if(_count>1){
			$controls = $thumbs.append('<a href="#prev" class="prev"></a><a href="#next" class="next"></a>').find('.prev, .next'); 
			var $prev = $controls.eq(0).hide(), 
				$next = $controls.eq(1);
			
			// 當點擊上下鈕時
			$controls.click(function(e){
				// 計算要顯示第幾組
				_countIndex = Math.floor((e.target.className == 'prev' ? _countIndex - 1 + _count : _countIndex + 1) % _count);
				
				// 進行動畫
				$ul.stop().animate({
					top: _countIndex * _height
				}, _animateSpeed);
				
				// 判斷上下鈕顯示與否
				$prev.toggle(_countIndex>0);
				$next.toggle(_countIndex!=_count-1);

				return false;
			});
		}
		
		// 如果縮圖 li 被點擊時
		$li.click(function(){
			var $this = $(this), 
				$a = $this.find('a'), 
				$img = $this.find('img');
			
			clearTimeout(timer);
			_index = $this.index();
			// 分別改變左邊顯示區塊的超連結, 圖片, alt 及描述內容
			$photoA.attr('href', $a.attr('href'));
			$photoImg.attr({
				src: $img.attr('src'), 
				alt: $img.attr('alt')
			});
			$photoDesc.html($img.attr('alt'));
			$this.addClass('current').siblings('.current').removeClass('current');
			
			// 如果目前的播放鈕並不是在播放樣式時, 就啟動計時器
			if(!$playPauseBtn.hasClass('playPause-btn-play')) timer = setTimeout(auto, speed + _animateSpeed);

			return false;
		}).eq(_index).click();
		
		// 當播放鈕被點擊時
		$playPauseBtn.click(function(){
			// 進行 .playPause-btn-pause 及 .playPause-btn-play 樣式切換
			var $this = $(this).toggleClass('playPause-btn-pause playPause-btn-play'), 
				_hasPlay = $this.hasClass('playPause-btn-play'), 
				_txt = _hasPlay ? '播放' : '暫停';
			
			// 如果目前的播放鈕並不是在播放樣式時, 就啟動計時器; 反之則停止計時器
			if(_hasPlay) clearTimeout(timer);
			else timer = setTimeout(auto, speed);
			$this.attr('title', _txt).text(_txt);

			return false;
		});
		
		// 自動輪播使用
		function auto(){
			_index = (_index + 1) % $li.length;
			var $tmp = $li.eq(_index).click();

			var _indexCount = Math.floor(_index / _set);
			// 判斷是否要切換縮圖的顯示組數
			if($controls != null && (_index == (_countIndex + 1) * _set || _index == 0) && _countIndex != _indexCount){
				$next.click();
				$tmp.animate({opacity: 1}, _animateSpeed, function(){
					$tmp.addClass('current').siblings('.current').removeClass('current');
				})
			}
		}
	});
</script>
</head>

<body>

<!-- <img src="https://farm1.staticflickr.com/741/20586793835_05435e8b46_k.jpg" width="2048" height="1152" alt="DSC_0004"> -->

<!-- <a data-flickr-embed="true"  href="https://www.flickr.com/photos/106592348@N08/20586793835" title="DSC_0004"><img src="https://farm1.staticflickr.com/741/20586793835_05435e8b46_k.jpg" width="2048" height="1152" alt="DSC_0004"></a><script async src="//embedr.flickr.com/assets/client-code.js" charset="utf-8"></script> -->
	<div id="abgne-block-20120804">
		<div class="photo">
			<a href="#">
				<img src="images/dsc_0342.jpg" alt="第一張圖片">
				<div class="desc-block">
					<div class="desc-bg"></div>
					<div class="desc-title">每一個都讓人流口水的義式麵包</div>
				</div>
			</a>
		</div>
		<div class="thumbs">
			<div class="carousel">
				<ul>
					<li><a href="#"><img src="images/dsc_0342.jpg" alt="每一個都讓人流口水的義式麵包" title="每一個都讓人流口水的義式麵包"></a></li>
					<li><a href="#"><img src="images/dsc_0385.jpg" alt="用來垃圾分類的綠寶、白寶、黃寶及藍寶" title="用來垃圾分類的綠寶、白寶、黃寶及藍寶"></a></li>
					<li><a href="#"><img src="images/dsc_0424.jpg" alt="龐貝城中用來表演用的露天劇場" title="龐貝城中用來表演用的露天劇場"></a></li>
					<li><a href="#"><img src="images/dsc_0535.jpg" alt="龐貝城中用來祭祀用的神壇" title="龐貝城中用來祭祀用的神壇"></a></li>
					<li><a href="#"><img src="images/dsc_0595.jpg" alt="Hotel Pazziella 的外觀" title="Hotel Pazziella 的外觀"></a></li>
					<li><a href="#"><img src="images/dsc_0575.jpg" alt="我來到一個島叫做卡不里島" title="我來到一個島叫做卡不里島"></a></li>
					<li><a href="#"><img src="images/dsc_0952.jpg" alt="在蘇連多的俏皮神像" title="在蘇連多的俏皮神像"></a></li>
					<li><a href="#"><img src="images/dsc_1882.jpg" alt="在艾曼紐二世迴廊中的可憐公牛" title="在艾曼紐二世迴廊中的可憐公牛"></a></li>
				</ul>
			</div>
		</div>
	</div>
</body>
</body>
</html>